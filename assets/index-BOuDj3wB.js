import{j as m}from"./jsx-runtime-BpbtHYHY.js";import{r as o}from"./index-BwPxMuoB.js";import{a as x,f as y,L as a}from"./proxy-BdCiNrpl.js";const C=o.createContext(null);function R(){const e=o.useRef(!1);return x(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function L(){const e=R(),[r,n]=o.useState(0),t=o.useCallback(()=>{e.current&&n(r+1)},[r]);return[o.useCallback(()=>y.postRender(t),[t]),r]}const G=e=>!e.isLayoutDirty&&e.willUpdate(!1);function d(){const e=new Set,r=new WeakMap,n=()=>e.forEach(G);return{add:t=>{e.add(t),r.set(t,t.addEventListener("willUpdate",n))},remove:t=>{e.delete(t);const s=r.get(t);s&&(s(),r.delete(t)),n()},dirty:n}}const l=e=>e===!0,I=e=>l(e===!0)||e==="id",M=({children:e,id:r,inherit:n=!0})=>{const t=o.useContext(a),s=o.useContext(C),[f,p]=L(),u=o.useRef(null),c=t.id||s;u.current===null&&(I(n)&&c&&(r=r?c+"-"+r:c),u.current={id:r,group:l(n)&&t.group||d()});const i=o.useMemo(()=>({...u.current,forceRender:f}),[p]);return m.jsx(a.Provider,{value:i,children:e})};export{M as L};
