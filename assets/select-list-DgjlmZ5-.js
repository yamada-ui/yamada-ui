import{j as b}from"./jsx-runtime-DztICxWZ.js";import{u as dt}from"./index-BdmKGyZV.js";import{r as s}from"./index-Bv9Y92EF.js";import{c as pt,a as ft}from"./icon-DKuqv-9Z.js";import{f as ue}from"./forward-ref-DH6f5tnY.js";import{K as Le,a1 as mt,p as xt,Q as te,av as ht,h as ee,d as re,E as Ze,a as ie,b as M,c as se,M as et,ae as tt,B as bt,a3 as Ct,aa as vt,g as st,ar as gt,a4 as _t,a5 as Se,u as yt,o as St,a2 as Ot,q as Pt}from"./factory-7Z88KRtK.js";import{u as It}from"./index-D3uVnNfI.js";import{c as kt}from"./index-CHX88LJr.js";import{u as jt}from"./index-CQqf5rDh.js";import{u as wt}from"./index-vKAUfVXn.js";import{u as Vt,f as Dt}from"./form-control-C8eO6U25.js";import{b as Ft}from"./popover-trigger-T6UAq76Q.js";const Nt=a=>{var l;return ht(a)&&!!((l=a.getAttribute("role"))!=null&&l.startsWith("option"))},Tt=a=>{const{closeOnSelect:l,fieldRef:c,focusedIndex:x,omitSelectedValues:n,placeholder:r,placeholderInOptions:d,setFocusedIndex:v,value:y,optionProps:P,onChange:F,onClose:h,onFocusNext:g}=z(),i=s.useId(),j=s.useRef(null),{id:B=i,children:w,closeOnSelect:I,isDisabled:u,disabled:p=u,isFocusable:O,focusable:A=O,icon:de,value:$,..._}={...P,...a},Pe=!!p&&!A,{descendants:pe,index:E,register:ne}=Rt({disabled:Pe}),fe=pe.values().slice(0,E),X=!!r&&d,me=X&&E===0,q=te(y),oe=E===x,G=s.useMemo(()=>{let V=$;return!me&&Le($)&&(mt(w)||xt(w)?V=w.toString():console.warn(`${q?"MultiSelect":"Select"}: Cannot infer the option value of complex children. Pass a \`value\` prop or use a plain string as children to <Option>.`)),X&&E>0&&!$&&console.warn(`${q?"MultiSelect":"Select"}: If placeholders are present, All options must be set value. If want to set an empty value, either don't set the placeholder or set \`placeholderInOptions\` to false.`),V??""},[w,X,E,q,me,$]),Q=q?!1:fe.some(({node:V})=>V.dataset.selectedValue===G),N=!Q&&(q?y.includes(G):G===y),ke=s.useCallback(V=>{if(V.preventDefault(),V.stopPropagation(),p||!Nt(V.currentTarget)){c.current&&c.current.focus();return}Q||v(E),F(G),c.current&&c.current.focus(),(I??l)&&h(),n&&g()},[p,Q,v,E,F,G,c,I,l,h,n,g]),L=s.useCallback((V={},xe=null)=>{const f={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"};return{ref:ie(j,xe,ne),role:"option",..._,...V,id:B,style:n&&N?f:void 0,"aria-disabled":Ze(p),"aria-selected":N,"data-disabled":re(p),"data-duplicated":re(Q),"data-focus":re(oe),"data-value":G,tabIndex:-1,onClick:ee(_.onClick,V.onClick,ke)}},[B,G,_,p,oe,Q,N,n,ke,ne]);return{children:w,customIcon:de,focused:oe,selected:N,getOptionProps:L}},Oe=ue(({className:a,icon:l,...c},x)=>{const{styles:n}=z(),{children:r,customIcon:d,selected:v,getOptionProps:y}=Tt(c);l??(l=d);const P={alignItems:"center",color:"inherit",display:"flex",flex:"0 0 auto",gap:"0.75rem",outline:0,textAlign:"start",textDecoration:"none",userSelect:"none",width:"100%",...n.item};return b.jsxs(M.div,{className:se("ui-select__item",a),__css:P,...y({},x),children:[l!==null?b.jsx(Re,{opacity:v?1:0,children:l||b.jsx(Et,{})}):null,b.jsx(M.span,{style:{flex:1},"data-label":!0,children:r})]})});Oe.displayName="Option";Oe.__ui__="Option";const Re=ue(({className:a,...l},c)=>{const{styles:x}=z(),n={alignItems:"center",display:"inline-flex",flexShrink:0,fontSize:"0.85em",justifyContent:"center",...x.itemIcon};return b.jsx(M.span,{ref:c,className:se("ui-select__item__icon",a),__css:n,...l})});Re.displayName="OptionIcon";Re.__ui__="OptionIcon";const Et=()=>b.jsx("svg",{height:"1em",viewBox:"0 0 14 14",width:"1em",children:b.jsx("polygon",{fill:"currentColor",points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})}),Lt=({label:a,...l})=>{const{omitSelectedValues:c,value:x}=z(),n=nt(),r=s.useRef(null),d=s.useId(),v=n.values(),F=(te(x)&&c?n.values(({node:u})=>x.includes(u.dataset.value??"")):[]).map(({index:u})=>u),g=!v.filter(({index:u,node:p})=>{var O;return((O=p.parentElement)==null?void 0:O.dataset.label)===a&&!F.includes(u)}).length,[i,j]=et(l,tt),B=s.useCallback((u={},p=null)=>{var A;const O={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",position:"absolute",whiteSpace:"nowrap",width:"1px"};return{ref:p,"aria-labelledby":(A=r.current)==null?void 0:A.id,role:"group",...u,...i,style:g?O:void 0}},[i,g]),w=s.useCallback(({id:u,...p}={},O=null)=>({id:u??d,ref:ie(O,r),role:"presentation",...p}),[d]),I=s.useCallback((u={},p=null)=>({ref:p,...u,...j,"data-label":a}),[j,a]);return{label:a,getContainerProps:B,getGroupProps:I,getLabelProps:w}},Ae=ue(({className:a,children:l,color:c,h:x,height:n=x,minH:r,minHeight:d=r,labelProps:v,...y},P)=>{const{styles:F}=z(),{label:h,getContainerProps:g,getGroupProps:i,getLabelProps:j}=Lt(y);return b.jsxs(M.section,{className:se("ui-select__item","ui-select__item--group",a),__css:{color:c,h:"fit-content",w:"100%"},...g(),children:[b.jsx(M.header,{className:"ui-select__item__group-label",lineClamp:1,__css:F.groupLabel,...j(v),children:h}),b.jsx(M.div,{...i({},P),className:"ui-select__item__group",height:n,minHeight:d,__css:F.group,children:l})]})});Ae.displayName="OptionGroup";Ae.__ui__="OptionGroup";const{DescendantsContextProvider:Zt,useDescendant:Rt,useDescendants:At,useDescendantsContext:nt}=kt(),[es,z]=bt({name:"SelectContext",errorMessage:`useSelectContext returned is 'undefined'. Seems you forgot to wrap the components in "<Select />"`}),ts=a=>{var Xe;const{animation:l,boundary:c,children:x,closeDelay:n,closeOnBlur:r=!0,closeOnEsc:d=!0,closeOnSelect:v=!0,defaultIsOpen:y,defaultOpen:P,defaultValue:F,duration:h=.2,eventListeners:g,flip:i,gutter:j,isLazy:B,isOpen:w,items:I=[],lazy:u=B,lazyBehavior:p,matchWidth:O=!0,maxSelectValues:A,modifiers:de,offset:$,omitSelectedValues:_=!1,open:Pe,openDelay:pe,placeholder:E,placeholderInOptions:ne=!0,placement:Ie="bottom-start",preventOverflow:fe,strategy:X,value:me,optionProps:q,onChange:oe,onClose:G,onOpen:Q,...N}=Vt(a),{"aria-readonly":ke,...L}=Ct(N,Dt),[V,xe]=et(vt(N,["aria-readonly"]),tt),f=At(),[K,S]=s.useState(-1),[He,Me]=s.useState(!1),he=s.useRef(null),Ge=s.useRef(null),Y=s.useRef(new Set([])),[D,be]=It({defaultValue:F,value:me,onChange:oe}),[Z,je]=s.useState(void 0),Ce=!!E&&ne,le=K>-1,C=te(D),Ke=(C?!D.length:!D)&&!Ce,W=f.values(({node:e})=>C&&D.includes(e.dataset.value??"")).map(({index:e})=>e),H=f.enabledValues(({index:e})=>!W.includes(e)),We=(Xe=f.value(K))==null?void 0:Xe.node.id,ve=st(x),ze=s.useMemo(()=>!ve.length&&I.length?I.map((e,t)=>{if("value"in e){const{label:o,value:k,...J}=e;return b.jsx(Oe,{value:k,...J,children:o},t)}else if("items"in e){const{items:o=[],label:k,...J}=e;return b.jsx(Ae,{label:k,...J,children:o.map(({label:Te,value:ye,...Ee},ce)=>b.jsx(Oe,{value:ye,...Ee,children:Te},ce))},t)}}).filter(Boolean):ve,[ve,I]),we=!ve.length&&!ze.length&&(C?!0:!Ce),ge=s.useCallback(()=>{const e=setTimeout(()=>{const t=f.enabledFirstValue();if(t)if(!C||!_)S(t.index);else if(W.includes(t.index)){const o=H[0];S((o==null?void 0:o.index)??-1)}else S(t.index)});Y.current.add(e)},[f,H,C,_,W]),_e=s.useCallback(()=>{const e=setTimeout(()=>{const t=f.enabledLastValue();if(t)if(!C||!_)S(t.index);else if(W.includes(t.index)){const o=H.reverse()[0];S((o==null?void 0:o.index)??-1)}else S(t.index)});Y.current.add(e)},[f,H,C,_,W]),Ve=s.useCallback(()=>{const e=setTimeout(()=>{const o=f.enabledValues().find(({node:k})=>C?D.includes(k.dataset.value??""):k.dataset.value===D);o&&S(o.index)});Y.current.add(e)},[f,C,D]),ae=s.useCallback(()=>{const e=setTimeout(()=>{const t=f.enabledNextValue(K);if(t)if(!C||!_)S(t.index);else if(W.includes(t.index)){const o=H.find(({index:k})=>t.index<k)??H[0];S((o==null?void 0:o.index)??-1)}else S(t.index)});Y.current.add(e)},[f,H,K,C,_,W,S]),De=s.useCallback(()=>{const e=setTimeout(()=>{const t=f.enabledPrevValue(K);if(t)if(!C||!_)S(t.index);else if(W.includes(t.index)){const o=H.reverse().find(({index:k})=>k<t.index)??H[0];S((o==null?void 0:o.index)??-1)}else S(t.index)});Y.current.add(e)},[f,H,K,C,_,W,S]),U=Ke||_?ge:Ve,Ue=Ke||_?_e:Ve,at=s.useCallback(e=>{const t=f.values();if(!t.length)return;const k=(te(e)?e:[e]).map(J=>{const{index:Te,node:ye}=t.find(({node:ce})=>ce.dataset.value===J)??{};if(!ye||Ce&&Te===0)return;const{innerHTML:Ee}=Array.from(ye.children).find(ce=>ce.getAttribute("data-label")!==null)??{};return Ee}).filter(J=>!Le(J));je(C?k:k[0])},[f,C,Ce]),Fe=s.useCallback(e=>{be(t=>te(t)?t.includes(e)?t.filter(k=>k!==e):[...t,e]:e)},[be]),ct=s.useCallback(e=>{e.stopPropagation(),be([]),je(void 0)},[je,be]),{open:m,onClose:T,onOpen:$e}=jt({defaultIsOpen:y,defaultOpen:P,isOpen:w,open:Pe,onClose:G,onOpen:Q}),R=s.useCallback(()=>{L.disabled||L.readOnly||we||He||$e()},[L,we,He,$e]),Ne=s.useCallback(()=>{let e=f.value(K);if("disabled"in((e==null?void 0:e.node.dataset)??{})&&(e=void 0),!e)return;const t=e.node.dataset.value??"";Fe(t),v&&T(),_&&ae()},[v,f,K,_,Fe,T,ae]),qe=s.useCallback(()=>{m||(R(),U())},[m,U,R]),Qe=s.useCallback(()=>{m||(R(),U())},[m,U,R]),Ye=s.useCallback(e=>{const t=gt(e);_t(he.current,t)||r&&m&&T()},[r,m,T]),Je=s.useCallback(e=>{if(e.key===" "&&(e.key=e.code),L.disabled||L.readOnly)return;const o={ArrowDown:le?()=>ae():m?void 0:Se(R,U),ArrowUp:e.altKey&&m?T:le?()=>De():m?void 0:Se(R,Ue),End:m?_e:void 0,Enter:le?Ne:m?void 0:Se(R,U),Escape:d?T:void 0,Home:m?ge:void 0,Space:le?Ne:m?void 0:Se(R,U)}[e.key];o&&(e.preventDefault(),e.stopPropagation(),o())},[L.disabled,L.readOnly,le,m,R,U,Ue,Ne,ge,_e,d,T,ae,De]);wt({ref:he,enabled:m&&r,handler:T}),s.useEffect(()=>{if(!C||!_&&Le(A))return;const e=D.length>0&&D.length===f.count(),t=D.length===A;e||t?(T(),Me(!0)):Me(!1)},[_,D,f,C,T,A]),yt(()=>{at(D)},[D]),St(()=>{m||S(-1)},[m]),Ot(()=>{Y.current.forEach(e=>clearTimeout(e)),Y.current.clear()});const rt=s.useCallback(e=>({animation:l,boundary:c,closeDelay:n,closeOnBlur:r,duration:h,eventListeners:g,flip:i,gutter:j,lazy:u,lazyBehavior:p,matchWidth:O,modifiers:de,offset:$,openDelay:pe,placement:Ie,preventOverflow:fe,strategy:X,...e,closeOnButton:!1,open:m,trigger:"never",onClose:T,onOpen:R}),[r,pe,n,u,p,l,h,$,j,fe,i,O,c,g,X,Ie,de,m,R,T]),it=s.useCallback((e={},t=null)=>({ref:ie(he,t),...V,...e,...L,onBlur:ee(e.onBlur,N.onBlur,Ye),onClick:ee(e.onClick,N.onClick,qe)}),[V,L,Ye,qe,N]),ut=s.useCallback(({"aria-label":e=E??`Select ${C?"one or more options.":"an option."}`,...t}={},o=null)=>({ref:ie(Ge,o),"aria-activedescendant":We,"aria-haspopup":"listbox","aria-label":e,role:"combobox",tabIndex:0,...xe,...t,"data-active":re(m),"data-placeholder":re(C?!(Z!=null&&Z.length):Z===void 0),onFocus:ee(t.onFocus,N.onFocus,Qe),onKeyDown:ee(t.onKeyDown,N.onKeyDown,Je)}),[We,xe,m,C,Z,E,N,Qe,Je]);return{children:ze,closeOnSelect:v,containerRef:he,descendants:f,empty:we,fieldRef:Ge,focusedIndex:K,label:Z,omitSelectedValues:_,open:m,placeholder:E,placeholderInOptions:ne,setFocusedIndex:S,value:D,formControlProps:L,getContainerProps:it,getFieldProps:ut,getPopoverProps:rt,optionProps:q,onChange:Fe,onClear:ct,onClose:T,onFocusFirst:ge,onFocusLast:_e,onFocusNext:ae,onFocusPrev:De,onFocusSelected:Ve,onOpen:R}},Be=ue(({className:a,children:l,__css:c,...x},n)=>{const{styles:r}=z(),d={alignItems:"center",cursor:"pointer",display:"inline-flex",justifyContent:"center",pointerEvents:"none",position:"absolute",top:"50%",transform:"translateY(-50%)",...r.icon,...c},y=st(l).map(P=>s.cloneElement(P,{style:{color:"currentColor",maxHeight:"1em",maxWidth:"1em"},"aria-hidden":!0,focusable:!1}));return b.jsx(M.div,{ref:n,className:se("ui-select__icon",a),__css:d,...x,children:Pt(l)?y:b.jsx(pt,{})})});Be.displayName="SelectIcon";Be.__ui__="SelectIcon";const ot=({className:a,children:l,...c})=>{const x=s.useRef(null),{styles:n}=z(),r=dt({ref:x,...c});return b.jsx(Be,{className:se("ui-select__clear-icon",a),"aria-label":"Clear value",__css:n.clearIcon,...r,children:l??b.jsx(ft,{h:"0.5em",w:"0.5em"})})};ot.displayName="SelectClearIcon";ot.__ui__="SelectClearIcon";const Bt=()=>{const{focusedIndex:a,open:l,value:c}=z(),x=nt(),n=s.useRef(null),r=s.useRef(-1),d=x.value(a),v=te(c),y=s.useCallback(()=>{var h;l||(h=n.current)==null||h.scrollTo({top:0})},[l]);s.useEffect(()=>{if(!n.current||!d||r.current===d.index)return;const h=n.current,g=d.node,i=h.clientHeight,j=h.scrollTop,B=j+i,w=g.clientHeight,I=g.offsetTop,u=I+w,p=j<=I&&u<=B,O=r.current<d.index;p||(u<=i?n.current.scrollTo({top:0}):O?n.current.scrollTo({top:u-i}):n.current.scrollTo({top:I+1})),r.current=d.index},[n,d]);const P=s.useCallback((h={},g=null)=>({ref:g,"aria-multiselectable":Ze(v),role:"listbox",...h,onAnimationComplete:ee(h.onAnimationComplete,y)}),[v,y]),F=s.useCallback((h={},g=null)=>({ref:ie(n,g),position:"relative",tabIndex:-1,...h}),[n]);return{getContainerProps:P,getListProps:F}},lt=ue(({className:a,children:l,footer:c,header:x,maxW:n,maxWidth:r=n,minW:d,minWidth:v=d,w:y,width:P=y,contentProps:F,...h},g)=>{var w,I,u,p,O,A;const{styles:i}=z(),{getContainerProps:j,getListProps:B}=Bt();return P??(P=((w=i.list)==null?void 0:w.width)??((I=i.list)==null?void 0:I.w)),v??(v=((u=i.list)==null?void 0:u.minWidth)??((p=i.list)==null?void 0:p.minW)),r??(r=((O=i.list)==null?void 0:O.maxWidth)??((A=i.list)==null?void 0:A.maxW)),b.jsxs(Ft,{as:"div",className:"ui-select__content",maxWidth:r,minWidth:v,width:P,__css:i.content,...j(F),children:[x?b.jsx(M.header,{className:"ui-select__header",__css:i.header,children:x}):null,b.jsx(M.div,{className:se("ui-select__list",a),__css:i.list,...B(h,g),children:l}),c?b.jsx(M.footer,{className:"ui-select__footer",__css:i.footer,children:c}):null]})});lt.displayName="SelectList";lt.__ui__="SelectList";export{Oe as O,Zt as S,es as a,Be as b,lt as c,z as d,Ae as e,ot as f,ts as u};
