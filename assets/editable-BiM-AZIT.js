import{d as ae,c as ue,a0 as ce,r as o,ap as J,a2 as de,N as be,h as u,m as E,f as fe,g as ge,j as M,s as Ce}from"./iframe-CzCJWi2Q.js";import{u as me}from"./index-Donn17eJ.js";import{u as pe}from"./index-DzcIk55C.js";import{u as he}from"./use-field-props-DhdxQdXh.js";import{u as ve}from"./use-input-border-DTHMWbY1.js";const Ee=ae({base:{control:{alignItems:"start",display:"inline-flex",gap:"sm"},input:{bg:"transparent",focusRingColor:"{focus-border-color}",focusVisibleRing:"inside",fontSize:"inherit",fontWeight:"inherit",minH:"1lh",p:"1",rounded:"l2",textAlign:"inherit",transitionDuration:"moderate",transitionProperty:"common",w:"full",_invalid:{borderColor:"{error-border-color}",focusRingColor:"{error-border-color}"},_disabled:{layerStyle:"disabled"}},preview:{bg:"transparent",cursor:"text",display:"inline-block",fontSize:"inherit",fontWeight:"inherit",minH:"1lh",p:"1",rounded:"l2",textAlign:"inherit",transitionDuration:"moderate",transitionProperty:"common",whiteSpace:"pre-line",_hover:{bg:"bg.subtle"},_readOnly:{pointerEvents:"none"},_disabled:{layerStyle:"disabled"}},root:{"--error-border-color":"colors.border.error","--focus-border-color":"colorScheme.outline",alignItems:"start",display:"inline-flex",gap:"sm",position:"relative",w:"full"},textarea:{bg:"transparent",boxSizing:"content-box",focusRingColor:"{focus-border-color}",focusVisibleRing:"inside",fontSize:"inherit",fontWeight:"inherit",minH:"1lh",p:"1",rounded:"l2",textAlign:"inherit",transitionDuration:"moderate",transitionProperty:"common",w:"full",_invalid:{borderColor:"{error-border-color}",focusRingColor:"{error-border-color}"},_disabled:{layerStyle:"disabled"}}}}),[Pe,C]=ue({name:"EditableContext"}),ye=(i={})=>{const{props:{id:r,defaultValue:T,disabled:l,placeholder:c,previewFocusable:I=!0,readOnly:p,required:h,selectAllOnFocus:P=!0,startWithEditView:V,submitOnBlur:k=!0,value:K,onCancel:S,onChange:Q,onEdit:X,onSubmit:j,...z},ariaProps:x,dataProps:s,eventProps:b}=he(i),H=ce(X),[n,_]=o.useState(!!V&&!l),[a,w]=me({defaultValue:T||"",value:K,onChange:Q}),R=!n&&!l,U=a.length===0,[A,q]=o.useState(a),f=o.useRef(null),Y=o.useRef(null),L=o.useRef(null),O=o.useRef(null),W=o.useRef(null),D=o.useCallback(e=>w(e.currentTarget.value),[w]),v=o.useCallback(()=>q(a),[a]),y=o.useCallback(()=>{R&&_(!0)},[R]),d=o.useCallback(()=>{_(!1),w(A),S?.(A)},[A,S,w]),g=o.useCallback(()=>{_(!1),q(a),j?.(a)},[j,a]),N=o.useCallback(e=>{if(!(e.key!=="Escape"&&e.key!=="Enter"))if(e.preventDefault(),e.key==="Escape")d();else{const{metaKey:t,shiftKey:B}=e;!B&&!t&&g()}},[d,g]),G=o.useCallback(e=>{e.key==="Escape"&&(e.preventDefault(),d())},[d]),F=o.useCallback(e=>{if(!n)return;const t=e.currentTarget.ownerDocument,B=e.relatedTarget??t.activeElement,se=J(O.current,B),le=J(W.current,B);!se&&!le&&(k?g():d())},[n,k,g,d]);pe({ref:f,elements:[O,W],enabled:n}),de(()=>{n&&(f.current?.focus(),P&&f.current?.select())},[]),be(()=>{if(!n){L.current?.focus();return}f.current?.focus(),P&&f.current?.select(),H()},[n,H,P]),o.useEffect(()=>{if(n)return;const e=f.current;e?.ownerDocument.activeElement===e&&e?.blur()},[n]);const Z=o.useCallback(e=>({...z,...s,...e}),[z,s]),$=o.useCallback(({ref:e,...t}={})=>({...s,...t,ref:E(Y,e),children:U?c:a,hidden:n,tabIndex:R&&I?0:void 0,onFocus:u(t.onFocus,y,v)}),[s,n,R,I,U,y,v,c,a]),ee=o.useCallback(({ref:e,...t}={})=>({...s,...x,...t,id:r,ref:E(f,e),disabled:l,hidden:!n,placeholder:c,readOnly:p,required:h,value:a,onBlur:u(b.onBlur,t.onBlur,F),onChange:u(t.onChange,D),onFocus:u(b.onFocus,t.onFocus,v),onKeyDown:u(t.onKeyDown,N)}),[s,x,r,l,n,c,p,h,a,b.onBlur,b.onFocus,F,D,v,N]),te=o.useCallback(({ref:e,...t}={})=>({...s,...x,...t,id:r,ref:E(f,e),disabled:l,hidden:!n,placeholder:c,readOnly:p,required:h,value:a,onBlur:u(b.onBlur,t.onBlur,F),onChange:u(t.onChange,D),onFocus:u(b.onFocus,t.onFocus,v),onKeyDown:u(t.onKeyDown,G)}),[s,x,r,l,n,c,p,h,a,b.onBlur,b.onFocus,F,D,v,G]),oe=o.useCallback(e=>({...s,role:"group",...e}),[s]),ne=o.useCallback(({ref:e,...t}={})=>({...s,...t,ref:E(L,e),disabled:l,hidden:n,onClick:u(t.onClick,y)}),[s,l,n,y]),re=o.useCallback(({ref:e,...t}={})=>({...s,...t,ref:E(W,e),disabled:l,hidden:!n,onClick:u(t.onClick,g)}),[s,l,n,g]),ie=o.useCallback(({ref:e,...t}={})=>({...s,...t,ref:E(O,e),disabled:l,hidden:!n,onClick:u(t.onClick,d)}),[s,l,n,d]);return{editing:n,value:a,getCancelProps:ie,getControlProps:oe,getEditProps:ne,getInputProps:ee,getPreviewProps:$,getRootProps:Z,getSubmitProps:re,getTextareaProps:te,onCancel:d,onEdit:y,onSubmit:g}},{withContext:m,withProvider:ke}=fe("editable",Ee),Be=ke(({children:i,errorBorderColor:r,focusBorderColor:T,...l})=>{const{editing:c,value:I,getRootProps:p,onCancel:h,onEdit:P,onSubmit:V,...k}=ye(l),K=ve({errorBorderColor:r,focusBorderColor:T}),S=ge(i,{editing:c,onCancel:h,onEdit:P,onSubmit:V});return M.jsx(Pe,{value:{editing:c,...k},children:M.jsx(Ce.div,{...p(),...K,children:S})})})(),Te=m("span","preview")(void 0,i=>{const{getPreviewProps:r}=C();return{...r(i)}}),Ie=m("input","input")(void 0,i=>{const{getInputProps:r}=C();return{...r(i)}}),Ve=m("textarea","textarea")(void 0,i=>{const{getTextareaProps:r}=C();return{...r(i)}}),Ke=m("div","control")(void 0,i=>{const{getControlProps:r}=C();return{...r(i)}}),_e=m("button",{name:"EditTrigger",slot:["trigger","edit"]})(void 0,i=>{const{getEditProps:r}=C();return{asChild:!0,...r(i)}}),Ae=m("button",{name:"CancelTrigger",slot:["trigger","cancel"]})(void 0,i=>{const{getCancelProps:r}=C();return{asChild:!0,...r(i)}}),Oe=m("button",{name:"SubmitTrigger",slot:["trigger","submit"]})(void 0,i=>{const{getSubmitProps:r}=C();return{asChild:!0,...r(i)}});export{Be as E,Te as a,Ie as b,Ve as c,Ke as d,_e as e,Oe as f,Ae as g,C as u};
