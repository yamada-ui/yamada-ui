import{d as le,c as ce,a7 as ue,r as o,F as M,aa as de,G as be,h as c,m as E,g as fe,k as ge,j as N,s as Ce}from"./iframe-Bn8cMbTR.js";import{u as me}from"./index-DxOQ1YS9.js";import{a as pe}from"./index-D737cZ0S.js";import{u as he}from"./use-field-props-DWTQjhl6.js";import{u as ve}from"./use-input-border-Ce8BP_Cj.js";const Ee=le({base:{control:{alignItems:"start",display:"inline-flex",gap:"sm"},input:{bg:"transparent",focusRingColor:"{focus-border-color}",focusVisibleRing:"inside",fontSize:"inherit",fontWeight:"inherit",minH:"1lh",p:"1",rounded:"l2",textAlign:"inherit",transitionDuration:"moderate",transitionProperty:"common",w:"full",_invalid:{borderColor:"{error-border-color}",focusRingColor:"{error-border-color}"},_disabled:{layerStyle:"disabled"}},preview:{bg:"transparent",cursor:"text",display:"inline-block",fontSize:"inherit",fontWeight:"inherit",minH:"1lh",p:"1",rounded:"l2",textAlign:"inherit",transitionDuration:"moderate",transitionProperty:"common",whiteSpace:"pre-line",_hover:{bg:"bg.subtle"},_readOnly:{pointerEvents:"none"},_disabled:{layerStyle:"disabled"}},root:{"--error-border-color":"colors.border.error","--focus-border-color":"colorScheme.outline",alignItems:"start",display:"inline-flex",gap:"sm",position:"relative",w:"full"},textarea:{bg:"transparent",boxSizing:"content-box",focusRingColor:"{focus-border-color}",focusVisibleRing:"inside",fontSize:"inherit",fontWeight:"inherit",minH:"1lh",p:"1",rounded:"l2",textAlign:"inherit",transitionDuration:"moderate",transitionProperty:"common",w:"full",_invalid:{borderColor:"{error-border-color}",focusRingColor:"{error-border-color}"},_disabled:{layerStyle:"disabled"}}}}),[Pe,C]=ce({name:"EditableContext"}),ye=(i={})=>{const{props:{id:r,defaultValue:T,disabled:a,placeholder:u,previewFocusable:I=!0,readOnly:p,required:h,selectAllOnFocus:P=!0,startWithEditView:V,submitOnBlur:k=!0,value:K,onCancel:S,onChange:Q,onEdit:X,onSubmit:j,...z},ariaProps:x,dataProps:s,eventProps:b}=he(i),H=ue(X),[n,_]=o.useState(!!V&&!a),[l,w]=me({defaultValue:T||"",value:K,onChange:Q}),R=!n&&!a,U=l.length===0,[A,q]=o.useState(l),f=o.useRef(null),Y=o.useRef(null),G=o.useRef(null),O=o.useRef(null),W=o.useRef(null),F=o.useCallback(e=>w(e.currentTarget.value),[w]),v=o.useCallback(()=>q(l),[l]),y=o.useCallback(()=>{R&&_(!0)},[R]),d=o.useCallback(()=>{_(!1),w(A),S?.(A)},[A,S,w]),g=o.useCallback(()=>{_(!1),q(l),j?.(l)},[j,l]),L=o.useCallback(e=>{if(!(e.key!=="Escape"&&e.key!=="Enter"))if(e.preventDefault(),e.key==="Escape")d();else{const{metaKey:t,shiftKey:B}=e;!B&&!t&&g()}},[d,g]),J=o.useCallback(e=>{e.key==="Escape"&&(e.preventDefault(),d())},[d]),D=o.useCallback(e=>{if(!n)return;const t=e.currentTarget.ownerDocument,B=e.relatedTarget??t.activeElement,se=M(O.current,B),ae=M(W.current,B);!se&&!ae&&(k?g():d())},[n,k,g,d]);pe({ref:f,elements:[O,W],enabled:n}),de(()=>{n&&(f.current?.focus(),P&&f.current?.select())},[]),be(()=>{if(!n){G.current?.focus();return}f.current?.focus(),P&&f.current?.select(),H()},[n,H,P]),o.useEffect(()=>{if(n)return;const e=f.current;e?.ownerDocument.activeElement===e&&e?.blur()},[n]);const Z=o.useCallback(e=>({...z,...s,...e}),[z,s]),$=o.useCallback(({ref:e,...t}={})=>({...s,...t,ref:E(Y,e),children:U?u:l,hidden:n,tabIndex:R&&I?0:void 0,onFocus:c(t.onFocus,y,v)}),[s,n,R,I,U,y,v,u,l]),ee=o.useCallback(({ref:e,...t}={})=>({...s,...x,...t,id:r,ref:E(f,e),disabled:a,hidden:!n,placeholder:u,readOnly:p,required:h,value:l,onBlur:c(b.onBlur,t.onBlur,D),onChange:c(t.onChange,F),onFocus:c(b.onFocus,t.onFocus,v),onKeyDown:c(t.onKeyDown,L)}),[s,x,r,a,n,u,p,h,l,b.onBlur,b.onFocus,D,F,v,L]),te=o.useCallback(({ref:e,...t}={})=>({...s,...x,...t,id:r,ref:E(f,e),disabled:a,hidden:!n,placeholder:u,readOnly:p,required:h,value:l,onBlur:c(b.onBlur,t.onBlur,D),onChange:c(t.onChange,F),onFocus:c(b.onFocus,t.onFocus,v),onKeyDown:c(t.onKeyDown,J)}),[s,x,r,a,n,u,p,h,l,b.onBlur,b.onFocus,D,F,v,J]),oe=o.useCallback(e=>({...s,role:"group",...e}),[s]),ne=o.useCallback(({ref:e,...t}={})=>({...s,...t,ref:E(G,e),disabled:a,hidden:n,onClick:c(t.onClick,y)}),[s,a,n,y]),re=o.useCallback(({ref:e,...t}={})=>({...s,...t,ref:E(W,e),disabled:a,hidden:!n,onClick:c(t.onClick,g)}),[s,a,n,g]),ie=o.useCallback(({ref:e,...t}={})=>({...s,...t,ref:E(O,e),disabled:a,hidden:!n,onClick:c(t.onClick,d)}),[s,a,n,d]);return{editing:n,value:l,getCancelProps:ie,getControlProps:oe,getEditProps:ne,getInputProps:ee,getPreviewProps:$,getRootProps:Z,getSubmitProps:re,getTextareaProps:te,onCancel:d,onEdit:y,onSubmit:g}},{withContext:m,withProvider:ke}=fe("editable",Ee),Be=ke(({children:i,errorBorderColor:r,focusBorderColor:T,...a})=>{const{editing:u,value:I,getRootProps:p,onCancel:h,onEdit:P,onSubmit:V,...k}=ye(a),K=ve({errorBorderColor:r,focusBorderColor:T}),S=ge(i,{editing:u,onCancel:h,onEdit:P,onSubmit:V});return N.jsx(Pe,{value:{editing:u,...k},children:N.jsx(Ce.div,{...p(),...K,children:S})})})(),Te=m("span","preview")(void 0,i=>{const{getPreviewProps:r}=C();return{...r(i)}}),Ie=m("input","input")(void 0,i=>{const{getInputProps:r}=C();return{...r(i)}}),Ve=m("textarea","textarea")(void 0,i=>{const{getTextareaProps:r}=C();return{...r(i)}}),Ke=m("div","control")(void 0,i=>{const{getControlProps:r}=C();return{...r(i)}}),_e=m("button",{name:"EditTrigger",slot:["trigger","edit"]})(void 0,i=>{const{getEditProps:r}=C();return{asChild:!0,...r(i)}}),Ae=m("button",{name:"CancelTrigger",slot:["trigger","cancel"]})(void 0,i=>{const{getCancelProps:r}=C();return{asChild:!0,...r(i)}}),Oe=m("button",{name:"SubmitTrigger",slot:["trigger","submit"]})(void 0,i=>{const{getSubmitProps:r}=C();return{asChild:!0,...r(i)}});export{Be as E,Te as a,Ie as b,Ve as c,Ke as d,_e as e,Oe as f,Ae as g,C as u};
