import{j as _}from"./jsx-runtime-CfatFE5O.js";import{r}from"./index-ClcD9ViR.js";import{t as Te,a as Ee,c as ze}from"./number-CcP_arM8.js";import{s as V,a3 as We,o as He,u as Xe,a as se,E as Ye,h as I,B as $e,b as ee,c as B}from"./factory-D0ba2aB7.js";import{u as Je}from"./index-I8sPqzTA.js";import{u as Qe}from"./index-OmvcrGgD.js";import{u as Ze,f as et}from"./form-control-BjOXh3qv.js";import{c as je}from"./icon-47ftZrjE.js";import{f as K}from"./forward-ref-D13m8o2p.js";import{a as tt}from"./use-component-style-B--WxH8d.js";import{o as nt}from"./theme-provider-r-UN7Xzc.js";const rt=({keepWithinRange:n=!0,max:o=Number.MAX_SAFE_INTEGER,min:s=Number.MIN_SAFE_INTEGER,...t}={})=>{const u=V(t.onChange),[d,m]=r.useState(()=>t.defaultValue==null?"":oe(t.defaultValue,t.step??1,t.precision)??""),p=typeof t.value<"u",a=p?t.value:d,h=Me(T(a),t.step??1),v=t.precision??h,f=r.useCallback(c=>{c!==a&&(p||m(c.toString()),u(c.toString(),T(c)))},[u,p,a]),i=r.useCallback(c=>{let l=c;return n&&(l=ze(l,s,o)),Te(l,v)},[v,n,o,s]),g=r.useCallback((c=t.step??1)=>{let l;a===""?l=T(c):l=T(a)+c,l=i(l),f(l)},[i,t.step,f,a]),D=r.useCallback((c=t.step??1)=>{let l;a===""?l=T(-c):l=T(a)-c,l=i(l),f(l)},[i,t.step,f,a]),j=r.useCallback(()=>{let c;t.defaultValue==null?c="":c=oe(t.defaultValue,t.step??1,t.precision)??s,f(c)},[t.defaultValue,t.precision,t.step,f,s]),O=r.useCallback(c=>{const l=oe(c,t.step??1,v)??s;f(l)},[v,t.step,f,s]),b=T(a),U=b<s||o<b,G=b===o,q=b===s;return{cast:O,clamp:i,decrement:D,increment:g,isMax:G,isMin:q,isOut:U,max:G,min:q,out:U,precision:v,reset:j,setValue:m,update:f,value:a,valueAsNumber:b}},T=n=>parseFloat(n.toString().replace(/[^\w.-]+/g,"")),Me=(n,o)=>Math.max(Ee(o),Ee(n)),oe=(n,o,s)=>(n=T(n),Number.isNaN(n)?void 0:Te(n,s??Me(n,o))),st=n=>/^[Ee0-9+\-.]$/.test(n),ot=({key:n,altKey:o,ctrlKey:s,metaKey:t},u)=>{const d=s||o||t;return!(n.length===1)||d?!0:u(n)},ke=({ctrlKey:n,metaKey:o,shiftKey:s})=>{let t=1;return(o||n)&&(t=.1),s&&(t=10),t},at=(n={})=>{const{id:o,name:s,allowMouseWheel:t,clampValueOnBlur:u=!0,defaultValue:d,focusInputOnChange:m=!0,format:p,getAriaValueText:a,inputMode:h="decimal",isValidCharacter:v,keepWithinRange:f=!0,max:i=Number.MAX_SAFE_INTEGER,min:g=Number.MIN_SAFE_INTEGER,parse:D,pattern:j="[0-9]*(.[0-9]+)?",precision:O,step:b,value:U,onChange:G,onInvalid:q,...c}=Ze(n),{"aria-invalid":l,disabled:P,readOnly:y,required:w,onBlur:Oe,onFocus:Le,...M}=We(c,et),[Be,le]=r.useState(!1),z=!(y||P),E=r.useRef(null),W=r.useRef(null),me=r.useRef(null),fe=r.useRef(null),de=V(I(Le,e=>{le(!0),W.current&&(e.target.selectionStart=W.current.start??e.currentTarget.value.length,e.currentTarget.selectionEnd=W.current.end??e.currentTarget.selectionStart)})),pe=V(I(Oe,()=>{le(!1),u&&Ke()})),ne=V(q),be=V(a),H=V(v??st),{cast:ge,max:Ce,min:Ne,out:xe,setValue:re,update:L,value:C,valueAsNumber:x,...X}=rt({defaultValue:d,keepWithinRange:f,max:i,min:g,precision:O,step:b,value:U,onChange:G}),Ie=r.useMemo(()=>{let e=be(C);return e??(e=C.toString(),e||void 0)},[C,be]),Y=r.useCallback(e=>e.split("").filter(H).join(""),[H]),$=r.useCallback(e=>(D==null?void 0:D(e))??e,[D]),F=r.useCallback(e=>((p==null?void 0:p(e))??e).toString(),[p]),J=r.useCallback((e=b??1)=>{z&&X.increment(e)},[z,X,b]),Q=r.useCallback((e=b??1)=>{z&&X.decrement(e)},[z,X,b]),Ke=r.useCallback(()=>{let e=C;if(C==="")return;/^[eE]/.test(C.toString())?re(""):(x<g&&(e=g),x>i&&(e=i),ge(e))},[ge,i,g,re,C,x]),_e=r.useCallback(e=>{if(e.nativeEvent.isComposing)return;const N=$(e.currentTarget.value);L(Y(N)),W.current={end:e.currentTarget.selectionEnd,start:e.currentTarget.selectionStart}},[$,L,Y]),ve=r.useCallback(e=>{if(e.nativeEvent.isComposing)return;ot(e,H)||e.preventDefault();const N=ke(e)*(b??1),S={ArrowDown:()=>Q(N),ArrowUp:()=>J(N),End:()=>L(i),Home:()=>L(g)}[e.key];S&&(e.preventDefault(),S(e))},[Q,J,H,i,g,b,L]),{down:ye,isSpinning:Se,stop:k,up:he}=ct(J,Q);Re(me,["disabled"],Se,k),Re(fe,["disabled"],Se,k);const Z=r.useCallback(()=>{m&&requestAnimationFrame(()=>{var e;(e=E.current)==null||e.focus()})},[m]),Pe=r.useCallback(e=>{e.preventDefault(),he(),Z()},[Z,he]),De=r.useCallback(e=>{e.preventDefault(),ye(),Z()},[Z,ye]);He(()=>{(x>i||x<g)&&ne("rangeOverflow",F(C),x)},[x,C,F,ne]),Xe(()=>{if(!E.current||!(E.current.value!=C))return;const N=$(E.current.value);re(Y(N))},[$,Y]),Je(()=>E.current,"wheel",e=>{var we;const A=(((we=E.current)==null?void 0:we.ownerDocument)??document).activeElement===E.current;if(!t||!A)return;e.preventDefault();const S=ke(e)*(b??1),R=Math.sign(e.deltaY);R===-1?J(S):R===1&&Q(S)},{passive:!1});const Ue=r.useCallback((e={},N=null)=>({id:o,type:"text",name:s,disabled:P,inputMode:h,pattern:j,readOnly:y,required:w,role:"spinbutton",...M,...e,ref:se(E,N),"aria-invalid":Ye(l??xe),"aria-valuemax":i,"aria-valuemin":g,"aria-valuenow":Number.isNaN(x)?void 0:x,"aria-valuetext":Ie,autoComplete:"off",autoCorrect:"off",max:i,min:g,step:b,value:F(C),onBlur:I(e.onBlur,pe),onChange:I(e.onChange,_e),onFocus:I(e.onFocus,de),onKeyDown:I(e.onKeyDown,ve)}),[o,s,h,j,w,P,y,M,i,g,b,F,C,x,Ie,l,xe,_e,ve,de,pe]),Ge=r.useCallback((e={},N=null)=>{var S;const A=P||f&&Ce;return{"aria-label":"Increase",disabled:A,readOnly:y,required:w,...M,...e,ref:se(N,me),style:{...e.style,cursor:y?"not-allowed":(S=e.style)==null?void 0:S.cursor},tabIndex:-1,onPointerDown:I(e.onPointerDown,R=>{R.button===0&&!A&&Pe(R)}),onPointerLeave:I(e.onPointerLeave,k),onPointerUp:I(e.onPointerUp,k)}},[P,f,Ce,w,y,M,k,Pe]),qe=r.useCallback((e={},N=null)=>{var S;const A=P||f&&Ne;return{"aria-label":"Decrease",disabled:A,readOnly:y,required:w,...M,...e,ref:se(N,fe),style:{...e.style,cursor:y?"not-allowed":(S=e.style)==null?void 0:S.cursor},tabIndex:-1,onPointerDown:I(e.onPointerDown,R=>{R.button===0&&!A&&De(R)}),onPointerLeave:I(e.onPointerLeave,k),onPointerUp:I(e.onPointerUp,k)}},[P,f,Ne,w,y,M,k,De]);return{disabled:P,focused:Be,isDisabled:P,isReadOnly:y,isRequired:w,props:c,readOnly:y,required:w,value:F(C),valueAsNumber:x,getDecrementProps:qe,getIncrementProps:Ge,getInputProps:Ue}},ut=50,Ae=300,ct=(n,o)=>{const[s,t]=r.useState(!1),[u,d]=r.useState(null),[m,p]=r.useState(!0),a=r.useRef(null),h=()=>clearTimeout(a.current);Qe(()=>{u==="increment"&&n(),u==="decrement"&&o()},s?ut:null);const v=r.useCallback(()=>{m&&n(),a.current=setTimeout(()=>{p(!1),t(!0),d("increment")},Ae)},[n,m]),f=r.useCallback(()=>{m&&o(),a.current=setTimeout(()=>{p(!1),t(!0),d("decrement")},Ae)},[o,m]),i=r.useCallback(()=>{p(!0),t(!1),h()},[]);return r.useEffect(()=>()=>h(),[]),{down:f,isSpinning:s,stop:i,up:v}},Re=(n,o,s,t)=>{r.useEffect(()=>{if(!n.current||!s)return;const u=n.current.ownerDocument.defaultView??window,d=new u.MutationObserver(m=>{for(const{type:p,attributeName:a}of m)p==="attributes"&&a&&o.includes(a)&&t()});return d.observe(n.current,{attributeFilter:o,attributes:!0}),()=>d.disconnect()})},[it,te]=$e({name:"NumberInputContext",errorMessage:`useNumberInputContext returned is 'undefined'. Seems you forgot to wrap the components in "<NumberInput />"`}),Fe=K((n,o)=>{const[s,t]=tt("NumberInput",n),{className:u,isStepper:d=!0,stepper:m=d,addonProps:p,containerProps:a,decrementProps:h,incrementProps:v,...f}=nt(t),{props:i,getDecrementProps:g,getIncrementProps:D,getInputProps:j}=at(f),O={position:"relative",zIndex:0,...s.container};return _.jsx(it,{value:{styles:s,getDecrementProps:g,getIncrementProps:D,getInputProps:j},children:_.jsxs(ee.div,{className:B("ui-number-input",u),role:"group",__css:O,...a,children:[_.jsx(ae,{...j(i,o)}),m?_.jsxs(ue,{...p,children:[_.jsx(ce,{...v}),_.jsx(ie,{...h})]}):null]})})});Fe.displayName="NumberInput";Fe.__ui__="NumberInput";const ae=K(({className:n,...o},s)=>{const{styles:t}=te(),u={width:"100%",...t.field};return _.jsx(ee.input,{ref:s,className:B("ui-number-input__field",n),__css:u,...o})});ae.displayName="NumberInputField";ae.__ui__="NumberInputField";const ue=K(({className:n,...o},s)=>{const{styles:t}=te(),u={display:"flex",flexDirection:"column",height:"calc(100% - 2px)",insetEnd:"0px",margin:"1px",position:"absolute",top:"0",zIndex:"fallback(yamcha, 1)",...t.addon};return _.jsx(ee.div,{ref:s,className:B("ui-number-input__addon",n),"aria-hidden":!0,__css:u,...o})});ue.displayName="NumberInputAddon";ue.__ui__="NumberInputAddon";const Ve=ee("button",{baseStyle:{alignItems:"center",cursor:"pointer",display:"flex",flex:1,justifyContent:"center",lineHeight:"normal",transitionDuration:"normal",transitionProperty:"common",userSelect:"none"}}),ce=K(({className:n,children:o,...s},t)=>{const{styles:u,getIncrementProps:d}=te(),m={...u.stepper};return _.jsx(Ve,{className:B("ui-number-input__stepper--up",n),...d(s,t),__css:m,children:o??_.jsx(je,{__css:{transform:"rotate(180deg)"}})})});ce.displayName="NumberIncrementStepper";ce.__ui__="NumberIncrementStepper";const ie=K(({className:n,children:o,...s},t)=>{const{styles:u,getDecrementProps:d}=te(),m={...u.stepper};return _.jsx(Ve,{className:B("ui-number-input__stepper--down",n),...d(s,t),__css:m,children:o??_.jsx(je,{})})});ie.displayName="NumberDecrementStepper";ie.__ui__="NumberDecrementStepper";export{Fe as N,at as u};
