import{r as l,au as J,ag as K,a2 as D}from"./iframe-Bh9OJiMa.js";const k=(w,d)=>{const x=getComputedStyle(w);return["auto","overlay","scroll"].includes(x.overflow)?!0:d?["auto","overlay","scroll"].includes(x.overflowY):["auto","overlay","scroll"].includes(x.overflowX)},M=({behavior:w,disabled:d=!1,indexRef:x,initialLoad:B=!1,orientation:P="vertical",resetRef:X,reverse:b=!1,rootMargin:I,rootRef:s,startIndex:Y=B?0:1,threshold:A,onLoad:j}={})=>{const T=l.useRef(null),{getDocument:p,getWindow:v}=J(),y=l.useRef(Y),g=l.useRef(!1),C=l.useRef(void 0),[q,E]=l.useState(!1),S=K(j),c=P==="vertical",h=c?"top":"left",O=l.useMemo(()=>({root:s==null?void 0:s.current,rootMargin:I,threshold:A}),[I,s,A]),z=l.useCallback((r=1,u=!0)=>{var n;if(y.current=r,E(!1),u){const e=s==null?void 0:s.current,t=(n=p())==null?void 0:n.body,i=e&&k(e,c)?e:t;if(i){const o=i===t?v():i,a=b?c?i.scrollHeight:i.scrollWidth:0;o==null||o.scrollTo({behavior:w,[h]:a})}}d||setTimeout(()=>{const e=C.current,t=T.current;t&&(e==null||e.observe(t))})},[d,s,p,c,v,b,w,h]),W=l.useCallback(()=>{const r=C.current,u=T.current;u&&(r==null||r.unobserve(u)),E(!0)},[]),F=l.useCallback(()=>new IntersectionObserver(async([u])=>{var a;const n=s==null?void 0:s.current,e=(a=p())==null?void 0:a.body,t=n&&k(n,c)?n:e;if(!(u!=null&&u.isIntersecting)||g.current||!t)return;const i={entry:u,finish:W,index:y.current};g.current=!0,n&&(n.ariaBusy="true");let o=0;b&&(o=c?t.scrollHeight:t.scrollWidth),await S(i),b&&setTimeout(()=>{const m=t===e?v():t,f=(c?t.scrollHeight:t.scrollWidth)-o;m==null||m.scrollTo({[h]:f})}),y.current+=1,g.current=!1,n&&(n.ariaBusy="false")},O),[O,s,p,c,W,b,S,v,h]);return l.useEffect(()=>{const r=()=>{const n=s==null?void 0:s.current;n&&k(n,c)&&!n.hasAttribute("tabindex")&&n.setAttribute("tabindex","0")},u=async()=>{var o;const n=T.current,e=y.current,t=s==null?void 0:s.current;if(B&&(g.current=!0,t&&(t.ariaBusy="true"),await S({finish:W,index:e}),y.current+=1,g.current=!1,t&&(t.ariaBusy="false")),d)return;C.current=F();const i=C.current;if(b){const a=s==null?void 0:s.current,m=(o=p())==null?void 0:o.body,f=a&&k(a,c)?a:m;if(f){const H=f===m?v():f,G=c?f.scrollHeight:f.scrollWidth;H==null||H.scrollTo({[h]:G})}}return setTimeout(()=>{n&&i.observe(n)}),()=>{n&&i.unobserve(n)}};r(),u()},[F,B,d,b,c,W,S,s,p,v,h]),D(X,z),D(x,r=>y.current=r),{ref:T,finish:q}};export{M as u};
