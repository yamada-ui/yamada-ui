import{r as n,a5 as X,am as Y,O as H,aM as I}from"./iframe-BHpF9Anv.js";const F=(c,r)=>{const e=getComputedStyle(c);return["auto","overlay","scroll"].includes(e.overflow)?!0:r?["auto","overlay","scroll"].includes(e.overflowY):["auto","overlay","scroll"].includes(e.overflowX)},R=({behavior:c,position:r,reverse:e,root:f,vertical:v})=>{let b;const t=I(f)&&F(f,v)?f:document.body;v?b={behavior:c,top:r??(e?t.scrollHeight:0)}:b={behavior:c,left:r??(e?t.scrollWidth:0)},t===document.body?window.scrollTo(b):t.scrollTo(b)},j=(c,r)=>{const e=I(c)&&F(c,r)?c:document.body;return r?e.scrollHeight-e.scrollTop:e.scrollWidth-e.scrollLeft},z=({behavior:c,disabled:r=!1,indexRef:e,initialLoad:f=!1,orientation:v="vertical",resetRef:b,reverse:t=!1,rootMargin:T,rootRef:u,startIndex:L=f?0:1,threshold:h,onLoad:M}={})=>{const y=n.useRef(null),m=n.useRef(L),d=n.useRef(!1),w=n.useRef(void 0),x=n.useRef(!1),C=n.useRef(0),[P,O]=n.useState(!1),S=X(M),a=v==="vertical",k=n.useMemo(()=>({root:u?.current,rootMargin:T,threshold:h}),[T,u,h]),W=n.useCallback((l=1,s=!0)=>{if(m.current=l,O(!1),s){const i=u?.current;R({behavior:c,reverse:t,root:i,vertical:a})}r||setTimeout(()=>{const i=w.current,o=y.current;o&&i?.observe(o)})},[r,t,u,a,c]),g=n.useCallback(()=>{const l=w.current,s=y.current;s&&l?.unobserve(s),O(!0)},[]),B=n.useCallback(()=>new IntersectionObserver(async([s])=>{if(!s?.isIntersecting||d.current)return;const i={entry:s,finish:g,index:m.current};d.current=!0;const o=u?.current;if(o&&(o.ariaBusy="true"),t&&(C.current=j(o,a)),await S(i),t){const p=C.current;R({position:p,root:o,vertical:a})}m.current+=1,d.current=!1,o&&(o.ariaBusy="false")},k),[g,S,k,u,t,a]);return n.useEffect(()=>{(async()=>{const s=y.current,i=x.current,o=m.current,p=u?.current;if(f&&!i&&(d.current=!0,p&&(p.ariaBusy="true"),await S({finish:g,index:o}),m.current+=1,d.current=!1,p&&(p.ariaBusy="false")),r)return;w.current=B();const E=w.current;if(t&&!i){const U=u?.current;R({reverse:t,root:U,vertical:a}),x.current=!0}return setTimeout(()=>{s&&E.observe(s)}),()=>{s&&E.unobserve(s)}})()},[B,f,r,t,a,g,S,u]),Y(()=>x.current=!1),H(b,W),H(e,l=>m.current=l),{ref:y,finish:P}};export{z as u};
