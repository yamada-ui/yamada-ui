import{r as g}from"./index-BwPxMuoB.js";import{B as P,u as E,N as V,a as _,O as S}from"./factory-B_KMcXyW.js";const m=t=>t.sort((u,d)=>{const r=u.compareDocumentPosition(d);return r&Node.DOCUMENT_POSITION_FOLLOWING||r&Node.DOCUMENT_POSITION_CONTAINED_BY?-1:r&Node.DOCUMENT_POSITION_PRECEDING||r&Node.DOCUMENT_POSITION_CONTAINS?1:((r&Node.DOCUMENT_POSITION_DISCONNECTED||r&Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC)&&console.warn("Cannot sort the given nodes."),0)}),v=(t,u,d)=>{let r=t+1;return d&&r>=u&&(r=0),r},T=(t,u,d)=>{let r=t-1;return d&&r<0&&(r=u),r},M=()=>{const t=new Map,u=e=>{t.forEach(n=>{const s=e.indexOf(n.node);n.index=s,n.node.dataset.index=n.index.toString()})},d=(e,n)=>{if(!e||t.has(e))return;const s=Array.from(t.keys()).concat(e),a=m(s);n!=null&&n.disabled&&(n.disabled=!!n.disabled);const D={index:-1,node:e,...n};t.set(e,D),u(a)},r=e=>{if(e!=null)return S(e)?d(e):n=>d(n,e)},c=e=>{if(e==null)return;t.delete(e);const n=m(Array.from(t.keys()));u(n)},x=()=>t.clear(),i=e=>l(e).length,I=e=>b(e).length,o=e=>{var n;return e?((n=t.get(e))==null?void 0:n.index)??-1:-1},f=(e,n)=>e==null?-1:b(n).findIndex(s=>s.node.isSameNode(e)),l=e=>{const n=Array.from(t.values());return e?n.filter(e).sort((s,a)=>s.index-a.index):n.sort((s,a)=>s.index-a.index)},b=e=>l(e).filter(({disabled:n})=>!n),N=(e,n)=>{if(i(n)!==0)return l(n)[e]},O=(e,n)=>{if(I(n)!==0)return b(n)[e]};return{count:i,destroy:x,enabledCount:I,enabledFirstValue:e=>O(0,e),enabledIndexOf:f,enabledLastValue:e=>O(b(e).length-1,e),enabledNextValue:(e,n,s=!0)=>{const a=N(e);if(!a)return;const D=f(a.node,n),C=v(D,I(n),s);return O(C,n)},enabledPrevValue:(e,n,s=!0)=>{const a=N(e);if(!a)return;const D=f(a.node,n),C=T(D,I(n)-1,s);return O(C,n)},enabledValue:O,enabledValues:b,firstValue:e=>N(0,e),indexOf:o,lastValue:e=>N(t.size-1,e),nextValue:(e,n,s=!0)=>{const a=v(e,i(n),s);return N(a,n)},prevValue:(e,n,s=!0)=>{const a=T(e,i(n)-1,s);return N(a,n)},register:r,unregister:c,value:N,values:l}},G=()=>{const[t,u]=P({name:"DescendantsProvider",errorMessage:"useDescendantsContext must be used within DescendantsContextProvider"});return{DescendantsContextProvider:t,useDescendant:c=>{const x=u(),[i,I]=g.useState(-1),o=g.useRef(null);E(()=>()=>{o.current&&x.unregister(o.current)},[]),E(()=>{if(!o.current)return;const l=Number(o.current.dataset.index);i!=l&&!Number.isNaN(l)&&I(l)});const f=c?V(x.register(c)):V(x.register);return{descendants:x,enabledIndex:x.enabledIndexOf(o.current,c==null?void 0:c.filter),index:i,register:_(f,o)}},useDescendants:()=>{const c=g.useRef(M());return E(()=>()=>c.current.destroy()),c.current},useDescendantsContext:u}};export{G as c};
