import{j as F}from"./jsx-runtime-CfatFE5O.js";import{C as pe}from"./close-button-CC97c4Av.js";import{f as ve}from"./forward-ref-D13m8o2p.js";import{B as ge,a as U,h as u,J as Pe,ar as S,a4 as x,c as ee,g as Ce,au as ye,b as be,a5 as he,e as Re}from"./factory-D0ba2aB7.js";import{s as z}from"./slide-fade-B_qqM4fM.js";import{s as xe}from"./scale-fade-C4ZlA-0I.js";import{m as Be}from"./forward-ref-2BKBy0Yi.js";import{m as _e}from"./factory-COvmBIaQ.js";import{r as t}from"./index-ClcD9ViR.js";import{b as Te}from"./index-DCP_Eude.js";import{u as we,b as Ee}from"./index-rZyt8EED.js";import{u as Fe,a as ke,b as Me}from"./index-DQZtUkQ0.js";import{u as De}from"./index-D8fKLhx4.js";import{a as Oe}from"./use-component-style-B--WxH8d.js";import{o as Ae}from"./theme-provider-r-UN7Xzc.js";const[je,V]=ge({name:"PopoverContext",errorMessage:`usePopoverContext returned is 'undefined'. Seems you forgot to wrap the components in "<Popover />"`}),oe=d=>{const[f,n]=Oe("Popover",d),{animation:h="scale",autoFocus:B=!0,children:p,closeDelay:v=200,closeOnBlur:a=!0,closeOnButton:L=!0,closeOnEsc:_=!0,duration:K,initialFocusRef:X,isLazy:k,lazy:Y=k,lazyBehavior:M="unmount",openDelay:D=200,relatedRef:C,restoreFocus:O=!0,trigger:c="click",...W}=Ae(n),y=t.useId(),{open:o,onClose:r,onOpen:R,onToggle:A}=we(n),T=t.useRef(null),s=t.useRef(null),j=t.useRef(null),q=t.useRef(null),g=t.useRef(null),{present:re,onAnimationComplete:se}=Te({ref:g,open:o}),b=t.useRef(void 0),H=t.useRef(void 0),w=t.useRef(!1),G=t.useRef(!1),{forceUpdate:Q,referenceRef:N,transformOrigin:Z,getPopperProps:ie}=De({...W,enabled:o});o&&(G.current=!0),t.useEffect(()=>()=>{b.current&&clearTimeout(b.current),H.current&&clearTimeout(H.current)},[]),Fe({ref:s,enabled:o}),ke(g,{focusRef:s,shouldFocus:O&&(c==="click"||c==="contextmenu"),visible:o}),Me(g,{focusRef:X,shouldFocus:B&&(c==="click"||c==="contextmenu"),visible:o});const ue=Ee({enabled:Y,isSelected:re,mode:M,wasSelected:G.current}),ae=t.useCallback((e={},E=null)=>{var l,P;const i={id:y,"aria-describedby":(l=q.current)==null?void 0:l.id,"aria-hidden":!o,"aria-labelledby":(P=j.current)==null?void 0:P.id,role:"dialog",...e,ref:U(g,E),style:{...e.style,transformOrigin:Z},tabIndex:-1,onBlur:u(e.onBlur,m=>{const J=S(m),fe=x(g.current,J),me=x(s.current,J),de=C!=null&&C.current?x(C.current,J):!1;o&&a&&(!fe&&!me&&!de)&&r()}),onKeyDown:u(e.onKeyDown,m=>{_&&m.key==="Escape"&&r()})};return c==="hover"&&(i.onMouseEnter=u(e.onMouseEnter,()=>{w.current=!0}),i.onMouseLeave=u(e.onMouseLeave,m=>{m.nativeEvent.relatedTarget!==null&&(w.current=!1,a&&setTimeout(r,v))})),i},[v,a,_,o,r,Z,c,C,y]),$=t.useCallback(e=>{T.current==null&&N(e)},[N]),ce=t.useCallback((e={},E=null)=>{const i={"aria-controls":o?y:void 0,"aria-expanded":o,role:"button",...e,ref:U(s,E,$)};return c==="click"&&(i.onClick=u(e.onClick,A),i.onBlur=u(e.onBlur,l=>{const P=S(l),m=!x(g.current,P);o&&a&&m&&r()})),c==="contextmenu"&&(i.onContextMenu=u(e.onContextMenu,l=>{l.preventDefault(),R()}),i.onBlur=u(e.onBlur,l=>{const P=S(l),m=!x(g.current,P);o&&a&&m&&r()})),c==="hover"&&(i.onFocus=u(e.onFocus,()=>{b.current===void 0&&R()}),i.onBlur=u(e.onBlur,l=>{const P=S(l),m=!x(g.current,P);o&&a&&m&&r()}),i.onKeyDown=u(e.onKeyDown,l=>{l.key==="Escape"&&r()}),i.onMouseEnter=u(e.onMouseEnter,()=>{w.current=!0,b.current=window.setTimeout(R,D)}),i.onMouseLeave=u(e.onMouseLeave,()=>{w.current=!1,b.current&&(clearTimeout(b.current),b.current=void 0),H.current=window.setTimeout(()=>{w.current||r()},v)})),i},[v,a,o,$,r,R,A,D,c,y]),le=t.useCallback((e={},E=null)=>({...e,ref:U(E,T,N)}),[T,N]);return F.jsx(je,{value:{id:y,animation:h,bodyRef:q,closeOnButton:L,duration:K,forceUpdate:Q,headerRef:j,open:o,shouldRenderContent:ue,styles:f,getAnchorProps:le,getPopoverProps:ae,getPopperProps:ie,getTriggerProps:ce,onAnimationComplete:se,onClose:r},children:Pe(p,{forceUpdate:Q,open:o,onClose:r})})};oe.displayName="Popover";oe.__ui__="Popover";const I=ve(({onClick:d,...f},n)=>{const{id:h,styles:B,onClose:p}=V(),v={position:"absolute",...B.closeButton};return F.jsx(pe,{ref:n,className:ee("ui-popover__close-button"),size:"sm","aria-controls":h,"aria-label":"Close popover",onClick:u(d,a=>{a.stopPropagation(),p==null||p()}),__css:v,...f})});I.displayName="PopoverCloseButton";I.__ui__="PopoverCloseButton";const Ne=(d="scale",f)=>{const n={duration:f,enter:{visibility:"visible"},reverse:!0,transitionEnd:{exit:{visibility:"hidden"}}};switch(d){case"scale":return{...xe,custom:{...n,scale:.95}};case"top":return{...z,custom:{...n,offsetX:0,offsetY:-16}};case"right":return{...z,custom:{...n,offsetX:16,offsetY:0}};case"left":return{...z,custom:{...n,offsetX:-16,offsetY:0}};case"bottom":return{...z,custom:{...n,offsetX:0,offsetY:16}}}},te=Be(({className:d,children:f,maxW:n,maxWidth:h=n,minW:B,minWidth:p=B,w:v,width:a=v,z:L,zIndex:_=L,containerProps:K,__css:X,...k},Y)=>{const{animation:M,closeOnButton:D,duration:C,open:O,shouldRenderContent:c,styles:W,getPopoverProps:y,getPopperProps:o,onAnimationComplete:r}=V();if(!c)return null;const R=Ce(f),[A,...T]=ye(R,I),s=X??W.container??{},j={display:"flex",flexDirection:"column",outline:0,position:"relative",w:"100%",...s};return a??(a=s.width??s.w),p??(p=s.minWidth??s.minW),h??(h=s.maxWidth??s.maxW),_??(_=s.zIndex??s.z),F.jsx(be.div,{...o({style:{visibility:O?"visible":"hidden"}}),className:"ui-popover",maxWidth:h,minWidth:p,outline:"none",width:a,zIndex:_,...K,children:F.jsxs(_e.section,{className:ee("ui-popover__content",d),...M!=="none"?Ne(M,C):{},...y(k,Y),animate:O?"enter":"exit",exit:"exit",initial:"exit",onAnimationComplete:he(r,k.onAnimationComplete),__css:j,children:[A??(D?F.jsx(I,{}):null),T]})})});te.displayName="PopoverContent";te.__ui__="PopoverContent";const ne=({children:d})=>{const f=t.Children.only(d),{getTriggerProps:n}=V();return t.cloneElement(f,n(f.props,Re(f)))};ne.displayName="PopoverTrigger";ne.__ui__="PopoverTrigger";export{oe as P,ne as a,te as b,I as c,V as u};
