import{r as n,a9 as X,ar as Y,P as H,aT as I}from"./iframe-DkaXVr_9.js";const P=(c,r)=>{const e=getComputedStyle(c);return["auto","overlay","scroll"].includes(e.overflow)?!0:r?["auto","overlay","scroll"].includes(e.overflowY):["auto","overlay","scroll"].includes(e.overflowX)},x=({behavior:c,position:r,reverse:e,root:f,vertical:v})=>{let b;const t=I(f)&&P(f,v)?f:document.body;v?b={behavior:c,top:r??(e?t.scrollHeight:0)}:b={behavior:c,left:r??(e?t.scrollWidth:0)},t===document.body?window.scrollTo(b):t.scrollTo(b)},j=(c,r)=>{const e=I(c)&&P(c,r)?c:document.body;return r?e.scrollHeight-e.scrollTop:e.scrollWidth-e.scrollLeft},z=({behavior:c,disabled:r=!1,indexRef:e,initialLoad:f=!1,orientation:v="vertical",resetRef:b,reverse:t=!1,rootMargin:R,rootRef:u,startIndex:F=f?0:1,threshold:h,onLoad:L}={})=>{const y=n.useRef(null),p=n.useRef(F),m=n.useRef(!1),w=n.useRef(void 0),g=n.useRef(!1),C=n.useRef(0),[W,k]=n.useState(!1),S=X(L),a=v==="vertical",B=n.useMemo(()=>({root:u?.current,rootMargin:R,threshold:h}),[R,u,h]),M=n.useCallback((l=1,s=!0)=>{if(p.current=l,k(!1),s){const i=u?.current;x({behavior:c,reverse:t,root:i,vertical:a})}r||setTimeout(()=>{const i=w.current,o=y.current;o&&i?.observe(o)})},[r,t,u,a,c]),T=n.useCallback(()=>{const l=w.current,s=y.current;s&&l?.unobserve(s),k(!0)},[]),E=n.useCallback(()=>new IntersectionObserver(async([s])=>{if(!s?.isIntersecting||m.current)return;const i={entry:s,finish:T,index:p.current};m.current=!0;const o=u?.current;if(o&&(o.ariaBusy="true"),t&&(C.current=j(o,a)),await S(i),t){const d=C.current;x({position:d,root:o,vertical:a})}p.current+=1,m.current=!1,o&&(o.ariaBusy="false")},B),[T,S,B,u,t,a]);return n.useEffect(()=>{(async()=>{const s=y.current,i=g.current,o=p.current,d=u?.current;if(f&&!i&&(m.current=!0,d&&(d.ariaBusy="true"),await S({finish:T,index:o}),p.current+=1,m.current=!1,d&&(d.ariaBusy="false")),r)return;w.current=E();const O=w.current;if(t&&!i){const U=u?.current;x({reverse:t,root:U,vertical:a}),g.current=!0}return setTimeout(()=>{s&&O.observe(s)}),()=>{s&&O.unobserve(s)}})()},[E,f,r,t,a,T,S,u]),Y(()=>g.current=!1),H(b,M),H(e,l=>p.current=l),{ref:y,finish:W}};export{z as u};
